<?xml version="1.0" encoding="UTF-8"?>
<odoo>
    <data>

        <record id="paperformat_project_task_cargo_report" model="report.paperformat">
            <field name="name">Reporte de carga</field>
            <field name="default" eval="True"/>
            <field name="format">custom</field>
            <field name="page_height">210</field>
            <field name="page_width">297</field>
            <field name="orientation">Portrait</field>
            <field name="margin_top">30</field>
            <field name="margin_bottom">20</field>
            <field name="margin_left">7</field>
            <field name="margin_right">7</field>
            <field name="header_line" eval="False"/>
            <field name="header_spacing">25</field>
            <field name="dpi">90</field>
        </record>

        <record id="project_task_cargo_report_action" model="ir.actions.report">
            <field name="name">Reporte de carga PDF</field>
            <field name="model">project.task</field>
            <field name="report_type">qweb-pdf</field>
            <field name="paperformat_id" ref="fleet_additionals.paperformat_project_task_cargo_report"/>
            <field name="report_name">fleet_additionals.report_project_task_cargo</field>
            <field name="report_file">fleet_additionals.report_project_task_cargo</field>
            <field name="print_report_name">'Reporte carga %s - %s' % (object.name, object.partner_id.name)</field>
            <field name="binding_model_id" ref="fleet_additionals.model_project_task"/>
            <field name="binding_type">report</field>
        </record>

        <template id="fleet_additionals.report_project_task_cargo">
            <t t-call="web.html_container">
                <t t-foreach="docs" t-as="o">
                    <t t-call="web.external_layout">
                            <div class="page">
                                <h2 class="text-center">Solicitud de carga
                                        <span t-field="o.partner_id.name"/>
                                    </h2>

                                <table class="table table-bordered mt32">
                                    <thead>
                                            <tr>
                                                <th class="text-center">
                                                    <span>Fecha</span>
                                                </th>
                                                <th class="text-center">
                                                    <span>Chofer</span>
                                                </th>
                                                <th class="text-center">
                                                    <span>RUT</span>
                                                </th>
                                                <th class="text-center">
                                                    <span>Patente Camión</span>
                                                </th>
                                                <th class="text-center">
                                                    <span>Patente Remolque</span>
                                                </th>
                                                <th class="text-center">
                                                    <span>Transportes</span>
                                                </th>

                                            </tr>
                                        </thead>
                                    <tbody>
                                            <tr class="text-center">
                                                <td>
                                                    <span t-field="o.dia_operacion"/>
                                                </td>
                                                <td>
                                                    <span t-field="o.chofer_camion"/>
                                                </td>
                                                <td>
                                                    <span t-field="o.remolque_id.rut_chofer_camion"/>
                                                </td>
                                                <td>
                                                    <span t-field="o.patente_camion_tracto"/>
                                                </td>
                                                <td>
                                                    <span t-field="o.patente_remolque"/>
                                                </td>
                                                <td>
                                                    <span />
                                                </td>
                                            </tr>
                                        </tbody>
                                </table>

                                <table class="table table-bordered mt32">
                                    <thead>
                                            <tr>
                                                <th class="text-center">
                                                    <span>C.Riesgo/UN</span>
                                                </th>
                                                <th class="text-center">
                                                    <span>Código</span>
                                                </th>
                                                <th class="text-center">
                                                    <span>Descripción</span>
                                                </th>
                                                <th class="text-center">
                                                    <span>Cantidad</span>
                                                </th>
                                                <th class="text-center">
                                                    <span>UM</span>
                                                </th>
                                                <th class="text-center">
                                                    <span>Cliente</span>
                                                </th>
                                                <th class="text-center">
                                                    <span>Destino</span>
                                                </th>
                                                <th class="text-center">
                                                    <span>OC</span>
                                                </th>
                                                <th class="text-center">
                                                    <span>Coste Flete</span>
                                                </th>
                                                <th class="text-center">
                                                    <span>Gd</span>
                                                </th>

                                            </tr>
                                        </thead>
                                    <tbody>
                                        <t t-set="cant_total" t-value="0"/>
                                        <t t-foreach="o.sale_order_id.order_line" t-as="sale_order">
                                            <tr class="text-center">
                                                <td>

                                                </td>
                                                <td>
                                                    <span t-field="sale_order.product_id.barcode"/>
                                                </td>
                                                <td>
                                                    <span t-field="sale_order.product_id.name"/>
                                                </td>
                                                <td>
                                                    <t t-set="cantidad_despachar" t-value="o.cantidad_despachar"/>
                                                    <span t-esc="cantidad_despachar" />
                                                    <t t-set="cant_total" t-value="cant_total + cantidad_despachar"/>
                                                </td>
                                                <td>
                                                    <span t-field="sale_order.product_id.uom_id.name"/>
                                                </td>
                                                <td>
                                                    <span t-field="o.partner_id.name"/>
                                                </td>
                                                <td>

                                                </td>
                                                <td>
                                                    <span t-field="o.sale_order_id.name"/>
                                                </td>
                                                <td>

                                                </td>
                                                <td>

                                                </td>
                                            </tr>
                                        </t>
                                            <tr>
                                                <td colspan="3" style="text-align:center;">
                                                    <span>Total</span>
                                                </td>

                                                <td style="text-align:center;">
                                                    <span t-esc="cant_total" />
                                                </td>
                                            </tr>
                                    </tbody>
                                </table>

                                <table class="table table-bordered mt32">
                                    <thead>
                                            <tr>
                                                <th class="text-center">
                                                    <span>Código</span>
                                                </th>
                                                <th class="text-center">
                                                    <span>Lote</span>
                                                </th>
                                                <th class="text-center">
                                                    <span>Fecha de vencimiento</span>
                                                </th>
                                            </tr>
                                        </thead>
                                    <tbody>
                                        <t t-foreach="o.sale_order_id.order_line" t-as="sale_order">
                                            <tr class="text-center">
                                                <td>
                                                    <span t-field="sale_order.product_id.barcode"/>
                                                </td>
                                                <td>

                                                </td>
                                                <td>

                                                </td>

                                            </tr>
                                        </t>
                                    </tbody>
                                </table>

                                <span>Observaciones</span>
                                <table style="padding-top: 16px;" class="table table-bordered mt32">
                                    <tbody>
                                        <t t-foreach="o.partner_id.child_ids" t-as="contacto">
                                            <tr class="text-center">
                                                <td style="text-align: left;">
                                                    <span>Contacto</span>
                                                    <span t-field="contacto.name"/>
                                                    <span t-field="contacto.mobile"/>
                                                </td>

                                            </tr>
                                        </t>
                                    </tbody>
                                </table>
                            </div>
                    </t>

                </t>
            </t>
        </template>


    </data>
</odoo>